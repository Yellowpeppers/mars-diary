# 火星日记模拟器 — Product Requirements Document (PRD v0.1)

> **目的**：为后续 AI/自动化伙伴、协作者提供单一信息源，明确产品目标、功能范围与交付标准。内容整合了前期世界观、提示词模板及单人开发方案。

---

## 1. 产品愿景

让任何人把自己的地球日常，瞬间投射到一个“可信又浪漫”的火星平行时空，并收获文字、图像甚至音视频形式的沉浸式回信。

---

## 2. 背景与机会

* 碎片化日记写作需求增长，与 AI 生成内容结合具备病毒式分享潜力。
* 市面缺乏“硬科幻 × 个人叙事”垂直体验；差异化强、易形成口碑。

---

## 3. 业务目标 & 指标 (90 天)

| 目标    | 指标                 | 说明          |
| ----- | ------------------ | ----------- |
| 抢眼冷启动 | ≥ 500 注册用户         | 小众科幻圈裂变     |
| 惊喜体验  | 首日 4⭐ + 好评率 ≥ 80 % | 新手首次生成后采样调查 |
| 留存    | D7 活跃留存 ≥ 40 %     | 免费功能即可达到    |
| 付费试探  | 免费→订阅转化 ≥ 8 %      | 暂不开发，做数据埋点  |

---

## 4. 目标用户 & Persona

| Persona                | 特征                       | 痛点     | 需求          |
| ---------------------- | ------------------------ | ------ | ----------- |
| **科幻迷 Leo** (25, 产品汪)  | 追《火星救援》、写 Bullet Journal | 写日记易弃坑 | 需要每日灵感激励    |
| **文青 May** (30, 插画师)   | 喜欢奇幻+视觉艺术                | 灵感枯竭   | 想生成可分享的火星插图 |
| **好奇宝宝 Taku** (18, 学生) | 沉迷新奇 App                 | 无持续兴趣  | 希望互动、低门槛试玩  |

---

## 5. 范围声明

### 5.1 In‑Scope (MVP)

1. **日记输入**：文本框≥20 字；写作提示占位。
2. **火星日记生成**：调用 GPT‑4o；使用统一 Prompt 模板（见附录 A）。
3. **占位图**：调用 Replicate SDXL 512 px；异步加载。
4. **用户系统**：Supabase Auth 邮箱魔法链接。
5. **时间线**：按 Sol 排序浏览/分享单篇。

### 5.2 Future / Out‑of‑Scope (v>1)

* 付费订阅、长记忆解锁、TTS 视频、多人互动市场、移动端 PWA 专属功能。

---

## 6. 功能需求

### 6.1 交互流程 (Happy Path)

1. 用户注册/登录账户。
2. 进入 `/write` 页面输入地球日记 → Loading → 显示火星日记 + 插图。
3. 点击"保存"自动保存到个人账户。
4. 进入 `/timeline` 查看历史；可以复制分享链接。

### 6.2 详细需求表

| #  | 功能       | 描述                       | 优先级    |
| -- | -------- | ------------------------ | ------ |
| F1 | 文本输入框    | 支持中文，≥20 字校验             | Must   |
| F2 | Gemini 生成   | 调用 `/api/diary`；超时降级提示   | Must   |
| F3 | 豆包插图    | 30 s 内完成；Skeleton UI     | Should |
| F4 | Auth     | Supabase 邮箱密码登录；会话存储 | Must   |
| F5 | Timeline | Card 列表；Sol label；可展开    | Must   |
| F6 | 分享       | 详情页公开；OG Image           | Could  |
| F7 | 设置       | 用户数据下载 / 删除              | Could  |

---

## 7. 非功能需求

* **性能**：TTFB ≤ 1 s；文字生成 ≤ 8 s。
* **可靠性**：99 % 生成成功率；失败重试 1 次并友好提示。
* **安全合规**：数据加密 / GDPR & PDPA 合规；用户可删除全部数据。
* **可维护性**：本地 `.env` 管理 Secrets；CI 检查通过才可合并。

---

## 8. 技术约束 & 依赖

| 领域    | 选型 / 版本                            | 备注                   |
| ----- | ---------------------------------- | -------------------- |
| 前端    | Next.js 14 + TypeScript + Tailwind | Vercel 部署 Serverless |
| 后端    | Next.js API Routes                 | 无独立服务器               |
| 数据    | Supabase (PostgreSQL 16)           | 免费层 500 MB           |
| 文本 AI | Google Gemini 2.5 Flash Lite       | 免费额度充足              |
| 图像 AI | 豆包 AI (doubao-seedream-3-0)      | REST 调用              |
| 部署    | Vercel                             | Serverless 部署        |
| 监控    | Vercel Analytics (Pro) + Sentry    | 免费层足够                |

---

## 9. 里程碑 & 交付物

| 日期 (周) | 里程碑                  | 交付物                      |
| ------ | -------------------- | ------------------------ |
| W1 End | 原型 & 核心页面 UI         | Figma 链接 + 交互说明          |
| W2 End | Phase 1 上线 (本地)      | `/write` 可生成文字           |
| W3 End | Phase 2 上线 (Auth+DB) | Timeline 功能打通            |
| W4 End | MVP 发布               | Vercel prod URL + README |

---

## 10. 成功判定 (验收标准)

* **F1\~F5** 功能在生产环境可用，无 P1 bug。
* 新用户从首页到生成第一篇日记 ≤ 2 分钟。
* 日志无敏感信息泄漏，Sentry 报错 < 5 / 1k 活跃会话。

---

## 11. 风险 & 缓解措施

| 风险      | 级别 | 缓解                         |
| ------- | -- | -------------------------- |
| AI 成本失控 | 中  | 生成次数限制 / Cache / Llama3 备选 |
| 图片生成慢   | 中  | 先返回文字，图片异步更新               |
| 单人精力不足  | 高  | MVP 功能锁定，避免 scope creep    |

---

## 12. 未来路线图 (FY +6 月)

1. **付费订阅**：高清插图、长记忆、多身份线。
2. **TTS + 视频**：阶段 3；自动分镜 + AI 配音。
3. **社交经济**：OxyCredit 交易、多人剧情事件。
4. **移动端 PWA**：离线日记、推送提醒。

---

## 附录

### A. Prompt Template v0.1 (摘要)

> 详见画布《火星日记生成提示词模板（v0.1）》文档。必须包含：世界观常量、随机事件清单、写作要求 5 条、用户输入占位符 `{EarthDiary}`。

### B. 世界观常量 & 场景清单

* 重力 0.38 g / 1 sol = 24h39m / CO₂ 95 % 稀薄大气
* 场景：阿瑞斯圆顶城、夜峡洞穴镇、极冠冰矿站、同步轨道电梯、尘暴流浪车队

---

> **版本记录**
> v0.1 – 2025‑07‑24：首版发布（整合世界观 & MVP 单人方案）。
